<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>نظام حجز الطيران — أمان للسفريات</title>

  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    body{margin:0;padding:30px;background:linear-gradient(135deg,#667eea,#764ba2);font-family:'Tajawal',sans-serif;min-height:100vh}
    .wrap{max-width:1000px;margin:auto}
    .card{background:#fff;border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,0.12);overflow:hidden}
    .hero{padding:18px;background:linear-gradient(90deg,#2563eb,#7c3aed);color:#fff;display:flex;justify-content:space-between;align-items:center}
    .brand{font-size:1.3rem;font-weight:700;display:flex;align-items:center;gap:10px}
    .content{padding:20px}

    .form-group{margin-bottom:20px}
    label{font-weight:600;margin-bottom:8px;display:block}

    /* Dropdown مطور */
    .dropdown{position:relative}
    .dropdown-toggle{width:100%;padding:12px 14px;border:1px solid #ddd;border-radius:12px;cursor:pointer;display:flex;align-items:center;justify-content:space-between;gap:8px;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,0.05)}
    .dropdown-toggle:hover{border-color:#2563eb}
    .selected-text{flex:1;text-align:right;color:#111}
    .dropdown-menu{position:absolute;top:110%;right:0;width:100%;background:#fff;border:1px solid #ddd;border-radius:12px;max-height:260px;overflow-y:auto;display:none;z-index:1000;box-shadow:0 8px 20px rgba(0,0,0,0.1);animation:fadeIn 0.2s ease}
    .dropdown.open .dropdown-menu{display:block}
    .dropdown-search{padding:8px;border-bottom:1px solid #eee}
    .dropdown-search input{width:100%;padding:10px;border:1px solid #ddd;border-radius:8px}
    .dropdown-item{padding:12px 14px;cursor:pointer;display:flex;align-items:center;gap:10px;transition:0.2s}
    .dropdown-item:hover{background:#f1f5f9}
    .dropdown-item i{color:#64748b}
    .dropdown-item span{flex:1}
    @keyframes fadeIn{from{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}

    /* أزرار */
    .btn{padding:12px 18px;border-radius:12px;cursor:pointer;font-weight:700;border:none;transition:0.3s}
    .btn-primary{background:linear-gradient(90deg,#2563eb,#7c3aed);color:#fff}
    .btn-primary:hover{opacity:0.9}

    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:18px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header class="hero">
        <div class="brand"><i class="fas fa-plane-departure"></i> نظام حجز الطيران — أمان للسفريات</div>
      </header>
      <div class="content">
        <form>
          <div class="grid">
            <!-- دولة -->
            <div class="form-group">
              <label><i class="fas fa-flag"></i> الدولة</label>
              <div class="dropdown" id="countryDropdown">
                <div class="dropdown-toggle">
                  <span class="selected-text">اختر الدولة</span>
                  <i class="fas fa-chevron-down"></i>
                </div>
                <div class="dropdown-menu">
                  <div class="dropdown-search"><input type="text" placeholder="ابحث عن دولة..."></div>
                  <div class="dropdown-list"></div>
                </div>
              </div>
            </div>

            <!-- مدينة -->
            <div class="form-group">
              <label><i class="fas fa-city"></i> المدينة</label>
              <div class="dropdown" id="cityDropdown">
                <div class="dropdown-toggle">
                  <span class="selected-text">اختر المدينة</span>
                  <i class="fas fa-chevron-down"></i>
                </div>
                <div class="dropdown-menu">
                  <div class="dropdown-search"><input type="text" placeholder="ابحث عن مدينة..."></div>
                  <div class="dropdown-list"></div>
                </div>
              </div>
            </div>

            <!-- مطار -->
            <div class="form-group">
              <label><i class="fas fa-plane"></i> المطار</label>
              <div class="dropdown" id="airportDropdown">
                <div class="dropdown-toggle">
                  <span class="selected-text">اختر المطار</span>
                  <i class="fas fa-chevron-down"></i>
                </div>
                <div class="dropdown-menu">
                  <div class="dropdown-search"><input type="text" placeholder="ابحث عن مطار..."></div>
                  <div class="dropdown-list"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- زر البحث -->
          <div style="margin-top:25px;text-align:center">
            <button type="button" class="btn btn-primary"><i class="fas fa-search"></i> بحث عن الرحلات</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    let airportsData = [];
    let selectedCountry = null;
    let selectedCity = null;

    // تحميل JSON
    async function loadAirports(){
      try {
        const res = await fetch("airports.json"); // ضع مسار ملفك
        airportsData = await res.json();
        fillCountries();
      } catch(e){
        console.error("خطأ بتحميل الملف", e);
      }
    }

    // تعبئة الدول
    function fillCountries(){
      const list = document.querySelector("#countryDropdown .dropdown-list");
      list.innerHTML = "";
      airportsData.forEach((c, idx)=>{
        const item = document.createElement("div");
        item.className="dropdown-item";
        item.innerHTML=`<i class="fas fa-flag"></i><span>${c["الدولة"]}</span>`;
        item.onclick=()=>{
          selectCountry(c);
        }
        list.appendChild(item);
      });
      setupDropdown(document.getElementById("countryDropdown"));
    }

    function selectCountry(country){
      selectedCountry = country;
      document.querySelector("#countryDropdown .selected-text").textContent = country["الدولة"];
      document.getElementById("countryDropdown").classList.remove("open");
      fillCities(country["مدن"]);
    }

    // تعبئة المدن
    function fillCities(cities){
      const list = document.querySelector("#cityDropdown .dropdown-list");
      list.innerHTML = "";
      document.querySelector("#cityDropdown .selected-text").textContent = "اختر المدينة";
      document.querySelector("#airportDropdown .dropdown-list").innerHTML = "";
      document.querySelector("#airportDropdown .selected-text").textContent = "اختر المطار";
      cities.forEach(city=>{
        const item = document.createElement("div");
        item.className="dropdown-item";
        item.innerHTML=`<i class="fas fa-city"></i><span>${city["المدينة"]}</span>`;
        item.onclick=()=>{
          selectCity(city);
        }
        list.appendChild(item);
      });
      setupDropdown(document.getElementById("cityDropdown"));
    }

    function selectCity(city){
      selectedCity = city;
      document.querySelector("#cityDropdown .selected-text").textContent = city["المدينة"];
      document.getElementById("cityDropdown").classList.remove("open");
      fillAirports(city["المطارات"]);
    }

    // تعبئة المطارات
    function fillAirports(airports){
      const list = document.querySelector("#airportDropdown .dropdown-list");
      list.innerHTML = "";
      document.querySelector("#airportDropdown .selected-text").textContent = "اختر المطار";
      airports.forEach(ap=>{
        const item = document.createElement("div");
        item.className="dropdown-item";
        item.innerHTML=`<i class="fas fa-plane"></i><span>${ap["الاسم"]} (${ap["الرمز"]})</span>`;
        item.onclick=()=>{
          document.querySelector("#airportDropdown .selected-text").textContent = `${ap["الاسم"]} (${ap["الرمز"]})`;
          document.getElementById("airportDropdown").classList.remove("open");
        }
        list.appendChild(item);
      });
      setupDropdown(document.getElementById("airportDropdown"));
    }

    // إعداد الـ dropdown مع البحث
    function setupDropdown(dropdown){
      const toggle = dropdown.querySelector(".dropdown-toggle");
      const menu = dropdown.querySelector(".dropdown-menu");
      const items = dropdown.querySelectorAll(".dropdown-item");
      const searchInput = dropdown.querySelector("input");

      toggle.onclick=()=> dropdown.classList.toggle("open");

      items.forEach(item=>{
        item.onclick=()=>{
          dropdown.classList.remove("open");
        }
      });

      searchInput.oninput=()=>{
        const val = searchInput.value.toLowerCase();
        items.forEach(it=>{
          it.style.display = it.textContent.toLowerCase().includes(val) ? "flex":"none";
        });
      };

      document.addEventListener("click",(e)=>{
        if(!dropdown.contains(e.target)){
          dropdown.classList.remove("open");
        }
      });
    }

    // تشغيل
    loadAirports();
  </script>
</body>
</html>
